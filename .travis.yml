language: node_js
cache: npm
node_js:
  - "10.13.0"

sudo: required

services:
  - docker
notifications:
  email: false
node_js:
  - node

before_install:
  - sudo apt-get install libsecret-1-dev
script:
  # start the subgraph docker containers
  - npm run docker:up
  - sleep 5
  - npm run test:prod
  - npm run build
after_success:
  - npm run report-coverage
  - test $TRAVIS_BRANCH = "master" && npm run deploy-docs
  - test $TRAVIS_BRANCH = "master" && npm run semantic-release
